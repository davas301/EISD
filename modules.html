

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Modules &mdash; EISD 0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="EISD 0.1 documentation" href="index.html"/>
        <link rel="next" title="References" href="references.html"/>
        <link rel="prev" title="Use" href="use.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> EISD</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">Getting Started</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#introduction">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#installation">Installation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="use.html">Use</a><ul>
<li class="toctree-l2"><a class="reference internal" href="use.html#calculating-eisd-probabilities">Calculating EISD probabilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="use.html#finding-optimal-subsets">Finding optimal subsets</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-eisd">eisd</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-backcalc">backcalc</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-priors">priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-structure">structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-readutil">readutil</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-util">util</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="references.html">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">EISD</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Modules</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="sources/modules.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-eisd">
<span id="eisd"></span><h2>eisd<a class="headerlink" href="#module-eisd" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="eisd.DataEISD">
<em class="property">class </em><code class="descclassname">eisd.</code><code class="descname">DataEISD</code><span class="sig-paren">(</span><em>back_calc</em>, <em>exp_data</em>, <em>no_exp_err=False</em>, <em>no_params=False</em>, <em>no_bc_err=False</em>, <em>no_opt=False</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD" title="Permalink to this definition">¶</a></dt>
<dd><p>Implementation of the Experimental Inferential Structure Determination
model. This does not include prior probabilities (priors should be
calculated separately). Each DataEISD object calculates probabilities
for one data type</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>back_calc</strong> &#8211; BaseBackCalculator object</li>
<li><strong>exp_data</strong> &#8211; experimental data corresponding to back-calc</li>
<li><strong>no_exp_err</strong> &#8211; True if experimental error should not contribute</li>
<li><strong>no_params</strong> &#8211; True if parameter probabilities should not contribute</li>
<li><strong>no_bc_err</strong> &#8211; True if back-calculation error should not contribute</li>
<li><strong>no_opt</strong> &#8211; True if no optimization should be performed&#8211;just calculate error probability from normal</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="eisd.DataEISD._eval">
<code class="descname">_eval</code><span class="sig-paren">(</span><em>structs</em>, <em>params</em>, <em>bc_err</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD._eval" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of structures,  bc_err, params and a data point index,
return the experimental error at the data point. This essentially
implements equation 5 in Brookes (2016).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structs</strong> &#8211; list of Structure objects</li>
<li><strong>params</strong> &#8211; back-calc parameters</li>
<li><strong>bc_err</strong> &#8211; back-calculation error</li>
<li><strong>j</strong> &#8211; index of data point</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">experimental error</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD._logp_bc_err">
<code class="descname">_logp_bc_err</code><span class="sig-paren">(</span><em>value</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD._logp_bc_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Log probability of back-calculation error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> &#8211; value of error</li>
<li><strong>j</strong> &#8211; index of data point</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">log probability</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD._logp_exp_err">
<code class="descname">_logp_exp_err</code><span class="sig-paren">(</span><em>value</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD._logp_exp_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Log probability of experimental error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> &#8211; error value</li>
<li><strong>j</strong> &#8211; index of experimental data point</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">log probability</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD._logp_params">
<code class="descname">_logp_params</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD._logp_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the log probability of back-calculator parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>value</strong> &#8211; back-calculator parameters</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">log probability of parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD._logp_total_err">
<code class="descname">_logp_total_err</code><span class="sig-paren">(</span><em>value</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD._logp_total_err" title="Permalink to this definition">¶</a></dt>
<dd><p>For the no-opt sceneario. Return log probability of an error
at data point j assuming the error distribution is a normal with
variance equal to the sum of the experimental and back-calculator
error variances</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>value</strong> &#8211; value of error</li>
<li><strong>j</strong> &#8211; index of data point</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">log probability</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD._random_bc_err">
<code class="descname">_random_bc_err</code><span class="sig-paren">(</span><em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD._random_bc_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random back-calculator error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>j</strong> &#8211; index of data point</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">random error</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD._random_exp_err">
<code class="descname">_random_exp_err</code><span class="sig-paren">(</span><em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD._random_exp_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random experimental error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>j</strong> &#8211; index of experimental data point</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">random error</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD._random_params">
<code class="descname">_random_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD._random_params" title="Permalink to this definition">¶</a></dt>
<dd><p>See BaseBackCalculator for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">random parameter set</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD.calc_logp">
<code class="descname">calc_logp</code><span class="sig-paren">(</span><em>structs</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD.calc_logp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the full EISD log probability given an ensemble
:param structs: list of Structure objects</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">log probability</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD.compute_all_back_calc">
<code class="descname">compute_all_back_calc</code><span class="sig-paren">(</span><em>structs</em>, <em>bc_params</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD.compute_all_back_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform back-calculation on every input structure for data point j</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structs</strong> &#8211; list of Structure objects</li>
<li><strong>bc_params</strong> &#8211; input parameters for back-calculator</li>
<li><strong>j</strong> &#8211; index of data point to back-calculate for</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">vector of back-calculations</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.DataEISD.compute_back_calc_mean">
<code class="descname">compute_back_calc_mean</code><span class="sig-paren">(</span><em>structs</em>, <em>bc_params</em>, <em>j</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.DataEISD.compute_back_calc_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute mean of back-calculation on input structures for data point j</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>structs</strong> &#8211; list of Structure objects</li>
<li><strong>bc_params</strong> &#8211; input parameters for back-calculator</li>
<li><strong>j</strong> &#8211; index of data point to back-calculate for</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">mean of back-calculations</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="eisd.EISDOPT">
<em class="property">class </em><code class="descclassname">eisd.</code><code class="descname">EISDOPT</code><span class="sig-paren">(</span><em>pdb_dir</em>, <em>prior</em>, <em>data_eisds</em>, <em>savefile</em>, <em>subsize=1000</em>, <em>verbose=True</em>, <em>stats_file=None</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.EISDOPT" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for optimizing an ensemble based on EISD probabilities</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pdb_dir</strong> &#8211; path to full ensemble of pdb structures</li>
<li><strong>prior</strong> &#8211; a BasePrior object</li>
<li><strong>data_eisds</strong> &#8211; list of DataEISD objects</li>
<li><strong>savefile</strong> &#8211; file to save best ensemble to (list of pdb names)</li>
<li><strong>subsize</strong> &#8211; size of sub-ensemble to optimize</li>
<li><strong>verbose</strong> &#8211; if True, will print updates</li>
<li><strong>stats_file</strong> &#8211; file to save statistics to (optional)</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="eisd.EISDOPT._build_start_set">
<code class="descname">_build_start_set</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#eisd.EISDOPT._build_start_set" title="Permalink to this definition">¶</a></dt>
<dd><p>Build a random start set of structures</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of files and list of Structure objects</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.EISDOPT._calc_data_prob">
<code class="descname">_calc_data_prob</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#eisd.EISDOPT._calc_data_prob" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the probability of the data for the current set of structures</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">probability of data</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.EISDOPT._perturb">
<code class="descname">_perturb</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#eisd.EISDOPT._perturb" title="Permalink to this definition">¶</a></dt>
<dd><p>Randomly remove a structure and add a random structure from the
reservoir</p>
</dd></dl>

<dl class="method">
<dt id="eisd.EISDOPT._restore">
<code class="descname">_restore</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#eisd.EISDOPT._restore" title="Permalink to this definition">¶</a></dt>
<dd><p>Restore the system to its state before the last perturbation</p>
</dd></dl>

<dl class="staticmethod">
<dt id="eisd.EISDOPT.default_cool">
<em class="property">static </em><code class="descname">default_cool</code><span class="sig-paren">(</span><em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.EISDOPT.default_cool" title="Permalink to this definition">¶</a></dt>
<dd><p>Default cooling schedule for simulated annealing</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>t</strong> &#8211; fraction of iterations</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">&#8220;Temperature&#8221; for simulated annealing</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="eisd.EISDOPT.opt">
<code class="descname">opt</code><span class="sig-paren">(</span><em>niter</em>, <em>cool_sched=None</em><span class="sig-paren">)</span><a class="headerlink" href="#eisd.EISDOPT.opt" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform simulated annealing procedure to find the subset of structures
that maximimizes probability. Requires the number of iterations and
the cooling schedule, which is a callable function that takes the
current fraction of iterations performed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>niter</strong> &#8211; number of iterations</li>
<li><strong>cool_sched</strong> &#8211; callable cooling schedule function</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-backcalc">
<span id="backcalc"></span><h2>backcalc<a class="headerlink" href="#module-backcalc" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="backcalc.BaseBackCalculator">
<em class="property">class </em><code class="descclassname">backcalc.</code><code class="descname">BaseBackCalculator</code><span class="sig-paren">(</span><em>nparams</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class for back calculators</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>nparams</strong> &#8211; number of nuisance parameters</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="backcalc.BaseBackCalculator.back_calc">
<code class="descname">back_calc</code><span class="sig-paren">(</span><em>xi</em>, <em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.back_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the back-calculation given a structural measurement and
necessary parameters.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xi</strong> &#8211; a Measurement returned by self.get_struct_data()</li>
<li><strong>params</strong> &#8211; list of nuisance parameter values for this back-calc</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a Measurement object containing the back-calculated value</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.BaseBackCalculator.get_default_err">
<code class="descname">get_default_err</code><span class="sig-paren">(</span><em>data_id</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.get_default_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the default (i.e. most probable) error for this back-calculator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; a DataID object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the default error corresponding to the input data id</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.BaseBackCalculator.get_default_params">
<code class="descname">get_default_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.get_default_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the default parameters for this back-calculator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of default values (one for each param)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.BaseBackCalculator.get_default_struct_val">
<code class="descname">get_default_struct_val</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.get_default_struct_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a default structural value for the relevant
structural information needed by this back-calculator.
Used to initialize models</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">default Measurement object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.BaseBackCalculator.get_err_sig">
<code class="descname">get_err_sig</code><span class="sig-paren">(</span><em>data_id</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.get_err_sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Get error standard deviation for a data point</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; DataID object for the data point</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.BaseBackCalculator.get_random_err">
<code class="descname">get_random_err</code><span class="sig-paren">(</span><em>data_id</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.get_random_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a value drawn from the error distribution of this back-calculator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; a DataID object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a random error taken from the distribution corresponding to the input data id</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.BaseBackCalculator.get_random_params">
<code class="descname">get_random_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.get_random_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Get values drawn randomly  from the distributions of this
back-calculator&#8217;s parameters</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">List of random values (one for each param)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.BaseBackCalculator.logp_err">
<code class="descname">logp_err</code><span class="sig-paren">(</span><em>err</em>, <em>data_id</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.logp_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log probability of an error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>err</strong> &#8211; the error value</li>
<li><strong>data_id</strong> &#8211; the DataID corresponding to the input error</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the log probability of the input error</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.BaseBackCalculator.logp_params">
<code class="descname">logp_params</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.BaseBackCalculator.logp_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the log probability of a set of parameter values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> &#8211; list of input parameters for this back-calculator</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">log probability of the input parameters</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="backcalc.JCoupBackCalc">
<em class="property">class </em><code class="descclassname">backcalc.</code><code class="descname">JCoupBackCalc</code><span class="sig-paren">(</span><em>err_mu=0</em>, <em>err_sig=0.73</em>, <em>mu_a=6.51</em>, <em>mu_b=-1.76</em>, <em>mu_c=1.6</em>, <em>sig_a=0.37416573867739417</em>, <em>sig_b=0.17320508075688773</em>, <em>sig_c=0.28284271247461901</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc" title="Permalink to this definition">¶</a></dt>
<dd><p>Back calculator for J-coupling constants from dihedral angles
Calculation is done with the Karplus equation: $$ J(phi) = Acos^2(phi) + Bcos(phi) + C $$
Constructor requires parameters for the Gaussian random variables
that will represent the coefficients in the Karplus equation
and a dictionary containing the errors mean and standard deviations
for every type of structural measurement. Default Karplus coeff means,
stdevs and and error stdev are the values based on those in:</p>
<blockquote>
<div>Vuister and Bax, &#8220;Quantatative J Correlation: a new approach for meausuring homonuclear
three bond J coupling constants in N15 eriched proteins&#8221; <em>J.Am.Chem.Soc</em>, <strong>1993</strong>,
<em>115</em> (17). pp 7772:7777</div></blockquote>
<dl class="method">
<dt id="backcalc.JCoupBackCalc.back_calc">
<code class="descname">back_calc</code><span class="sig-paren">(</span><em>xi</em>, <em>back_params</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.back_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>Implemenation of the Karplus equation. See BaseBackCalculator for more
info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>xi</strong> &#8211; </li>
<li><strong>back_params</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.JCoupBackCalc.get_default_err">
<code class="descname">get_default_err</code><span class="sig-paren">(</span><em>data_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.get_default_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Default if mean of error distribution See BaseBackCalculator for more
info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.JCoupBackCalc.get_default_params">
<code class="descname">get_default_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.get_default_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return mean of param values. See BaseBackCalculator for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.JCoupBackCalc.get_default_struct_val">
<code class="descname">get_default_struct_val</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.get_default_struct_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Default is [pi, pi] dihedral angle. See BaseBackCalculator for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.JCoupBackCalc.get_err_sig">
<code class="descname">get_err_sig</code><span class="sig-paren">(</span><em>data_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.get_err_sig" title="Permalink to this definition">¶</a></dt>
<dd><p>See BaseBackCalculator for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.JCoupBackCalc.get_random_err">
<code class="descname">get_random_err</code><span class="sig-paren">(</span><em>data_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.get_random_err" title="Permalink to this definition">¶</a></dt>
<dd><p>data_id is optional for this back-calculator. See BaseBackCalculator for
more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.JCoupBackCalc.get_random_params">
<code class="descname">get_random_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.get_random_params" title="Permalink to this definition">¶</a></dt>
<dd><p>See BaseBackCalculator for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.JCoupBackCalc.logp_err">
<code class="descname">logp_err</code><span class="sig-paren">(</span><em>err</em>, <em>data_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.logp_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Error is represemted as a normal. See BaseBackCalculator for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>err</strong> &#8211; </li>
<li><strong>data_id</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.JCoupBackCalc.logp_params">
<code class="descname">logp_params</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.JCoupBackCalc.logp_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Parameters are represented as normals. See BaseBackCalculator for more
info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="backcalc.ShiftBackCalc">
<em class="property">class </em><code class="descclassname">backcalc.</code><code class="descname">ShiftBackCalc</code><a class="headerlink" href="#backcalc.ShiftBackCalc" title="Permalink to this definition">¶</a></dt>
<dd><p>Back calculator for converting pdb files to chemical shifts.
Uses SHIFTX2 for the back-calculation, which has no nuisance
parameters</p>
<dl class="method">
<dt id="backcalc.ShiftBackCalc.back_calc">
<code class="descname">back_calc</code><span class="sig-paren">(</span><em>xi</em>, <em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.back_calc" title="Permalink to this definition">¶</a></dt>
<dd><p>In this case, xi contains the back-calculated measurement.
See BaseBackCalculator for more info.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>xi</strong> &#8211; </li>
<li><strong>params</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.ShiftBackCalc.get_default_err">
<code class="descname">get_default_err</code><span class="sig-paren">(</span><em>data_id=None</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.get_default_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Default is 0.0. See BaseBackCalculator for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.ShiftBackCalc.get_default_params">
<code class="descname">get_default_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.get_default_params" title="Permalink to this definition">¶</a></dt>
<dd><p>No nuisance parameters required for this model. See BaseBackCalculator
for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.ShiftBackCalc.get_default_struct_val">
<code class="descname">get_default_struct_val</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.get_default_struct_val" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a shift id for the first measurement of the first
structure</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.ShiftBackCalc.get_err_sig">
<code class="descname">get_err_sig</code><span class="sig-paren">(</span><em>data_id</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.get_err_sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the std corresponding to the SHIFTX2 rmsd for this data id</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.ShiftBackCalc.get_random_err">
<code class="descname">get_random_err</code><span class="sig-paren">(</span><em>data_id</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.get_random_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a random value from the normal distribution corresponding
to the SHIFTX2 rmsd value for this data id. See BaseBackCalculator
for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>data_id</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.ShiftBackCalc.get_random_params">
<code class="descname">get_random_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.get_random_params" title="Permalink to this definition">¶</a></dt>
<dd><p>No nuisance parameters required for this model. See BaseBackCalculator
for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.ShiftBackCalc.logp_err">
<code class="descname">logp_err</code><span class="sig-paren">(</span><em>err</em>, <em>data_id</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.logp_err" title="Permalink to this definition">¶</a></dt>
<dd><p>Error represented as gaussian with std based on SHIFTX2 reported rmsd
See BaseBackCalculator for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>err</strong> &#8211; </li>
<li><strong>data_id</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="backcalc.ShiftBackCalc.logp_params">
<code class="descname">logp_params</code><span class="sig-paren">(</span><em>params=None</em><span class="sig-paren">)</span><a class="headerlink" href="#backcalc.ShiftBackCalc.logp_params" title="Permalink to this definition">¶</a></dt>
<dd><p>No nuisance parameters required for this model. See BaseBackCalculator
for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-priors">
<span id="priors"></span><h2>priors<a class="headerlink" href="#module-priors" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="priors.BasePrior">
<em class="property">class </em><code class="descclassname">priors.</code><code class="descname">BasePrior</code><a class="headerlink" href="#priors.BasePrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class for prior distributions</p>
<dl class="method">
<dt id="priors.BasePrior.calc_prior_logp">
<code class="descname">calc_prior_logp</code><span class="sig-paren">(</span><em>*args</em><span class="sig-paren">)</span><a class="headerlink" href="#priors.BasePrior.calc_prior_logp" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate the prior log probability for a list of Structures that make
up an ensemble</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>args</strong> &#8211; specific arguments</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">log probability of ensemble in this prior distribution</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="priors.BasePrior.get_arg">
<code class="descname">get_arg</code><span class="sig-paren">(</span><em>struct</em><span class="sig-paren">)</span><a class="headerlink" href="#priors.BasePrior.get_arg" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the arguments required to calculate the prior given a
single structure. So the input to calc_prior_logp shoudl be a
list of these args</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>struct</strong> &#8211; a Structure object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="priors.UniformPrior">
<em class="property">class </em><code class="descclassname">priors.</code><code class="descname">UniformPrior</code><span class="sig-paren">(</span><em>n</em><span class="sig-paren">)</span><a class="headerlink" href="#priors.UniformPrior" title="Permalink to this definition">¶</a></dt>
<dd><p>Uniform prior distribuiton across space of ensembles</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>n</strong> &#8211; number of candidate ensembles</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="priors.UniformPrior.calc_prior_logp">
<code class="descname">calc_prior_logp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#priors.UniformPrior.calc_prior_logp" title="Permalink to this definition">¶</a></dt>
<dd><p>Probability is just 1/n. See BasePrior for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="priors.UniformPrior.get_arg">
<code class="descname">get_arg</code><span class="sig-paren">(</span><em>struct=None</em><span class="sig-paren">)</span><a class="headerlink" href="#priors.UniformPrior.get_arg" title="Permalink to this definition">¶</a></dt>
<dd><p>No arguments for this prior. See BasePrior for more info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>struct</strong> &#8211; a Structure object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-structure">
<span id="structure"></span><h2>structure<a class="headerlink" href="#module-structure" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="structure.Structure">
<em class="property">class </em><code class="descclassname">structure.</code><code class="descname">Structure</code><span class="sig-paren">(</span><em>pdbfile</em>, <em>shiftxfile=None</em>, <em>runshiftx=None</em>, <em>energy=None</em><span class="sig-paren">)</span><a class="headerlink" href="#structure.Structure" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for representing and modifying protein structures. Interfaces
significantly with MMTK.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>pdbfile</strong> &#8211; path to the pdbfile containing the representation of this structure</li>
<li><strong>shiftxfile</strong> &#8211; file containing back-calculated SHIFTX2 data for this structure</li>
<li><strong>runshiftx</strong> &#8211; an optional RunShiftX instance</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="structure.Structure._get_all_dihed">
<code class="descname">_get_all_dihed</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#structure.Structure._get_all_dihed" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all phi, psi dihedral angles in this structure</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a {res_num: (phi, psi)} dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="structure.Structure.get_struct_measure">
<code class="descname">get_struct_measure</code><span class="sig-paren">(</span><em>exp_id</em><span class="sig-paren">)</span><a class="headerlink" href="#structure.Structure.get_struct_measure" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a structural measurement from a DataID corresponding to an
experimental measurement. This structural measurement can be
input into a back-calculator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>exp_id</strong> &#8211; An experimental data ID (ShiftID or JCoupID)</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-readutil">
<span id="readutil"></span><h2>readutil<a class="headerlink" href="#module-readutil" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="readutil.BaseDataID">
<em class="property">class </em><code class="descclassname">readutil.</code><code class="descname">BaseDataID</code><a class="headerlink" href="#readutil.BaseDataID" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for objects that contain unique IDs for data points. The goal
of these classes is to ensure that experimental measurements are
solidly connected to the corresponding structural and back-calculation
measurements. These IDs must be hashable and have equality comparisons</p>
</dd></dl>

<dl class="class">
<dt id="readutil.JCoupID">
<em class="property">class </em><code class="descclassname">readutil.</code><code class="descname">JCoupID</code><span class="sig-paren">(</span><em>res_num</em><span class="sig-paren">)</span><a class="headerlink" href="#readutil.JCoupID" title="Permalink to this definition">¶</a></dt>
<dd><p>ID objects for j coupling values. Only requires a residue number</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>res_num</strong> &#8211; residue number of measurement</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="readutil.Measurement">
<em class="property">class </em><code class="descclassname">readutil.</code><code class="descname">Measurement</code><span class="sig-paren">(</span><em>data_id=None</em>, <em>val=None</em><span class="sig-paren">)</span><a class="headerlink" href="#readutil.Measurement" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for storing all of the info in a data measurement
(experimental or structural). Contains a data ID and a value</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>data_id</strong> &#8211; a BaseDataID object</li>
<li><strong>val</strong> &#8211; value of the measurement</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="readutil.RunShiftX">
<em class="property">class </em><code class="descclassname">readutil.</code><code class="descname">RunShiftX</code><span class="sig-paren">(</span><em>exe='/usr/local/bin/shiftx2/shiftx2.py'</em>, <em>tempdir='./tmp/'</em><span class="sig-paren">)</span><a class="headerlink" href="#readutil.RunShiftX" title="Permalink to this definition">¶</a></dt>
<dd><p>Class for running the SHIFTX2 command line program</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>exe</strong> &#8211; path to SHIFTX2 executable</li>
<li><strong>tempdir</strong> &#8211; path to a directory to story temporary files</li>
</ul>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="readutil.RunShiftX._clean">
<code class="descname">_clean</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#readutil.RunShiftX._clean" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes temporary files</p>
</dd></dl>

<dl class="staticmethod">
<dt id="readutil.RunShiftX.read_ouput">
<em class="property">static </em><code class="descname">read_ouput</code><span class="sig-paren">(</span><em>f</em><span class="sig-paren">)</span><a class="headerlink" href="#readutil.RunShiftX.read_ouput" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads a shiftx2 output file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>f</strong> &#8211; output file to be read</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">{ShiftID: shift_val} dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="readutil.RunShiftX.run_shiftx_once">
<code class="descname">run_shiftx_once</code><span class="sig-paren">(</span><em>inpath</em>, <em>backbone_only=False</em>, <em>clean=True</em>, <em>no_output=True</em><span class="sig-paren">)</span><a class="headerlink" href="#readutil.RunShiftX.run_shiftx_once" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs SHIFTX2 for a single input pdb file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>inpath</strong> &#8211; path to input pdb file</li>
<li><strong>backbone_only</strong> &#8211; True if SHIFTX2 should only run for backbone atoms</li>
<li><strong>clean</strong> &#8211; True if the temporary files should be deleted</li>
<li><strong>no_output</strong> &#8211; If true, no SHIFTX2 ouput will be shown on</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">path to output &#8221;.cs&#8221; file</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="readutil.ShiftID">
<em class="property">class </em><code class="descclassname">readutil.</code><code class="descname">ShiftID</code><span class="sig-paren">(</span><em>res_num</em>, <em>atom_name</em><span class="sig-paren">)</span><a class="headerlink" href="#readutil.ShiftID" title="Permalink to this definition">¶</a></dt>
<dd><p>Storage objects containing information that identifies a unique chemical
shift. A shift is defined by a residue number and atom name</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>res_num</strong> &#8211; residue number of measurement</li>
<li><strong>atom_name</strong> &#8211; name of atom with residue</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="readutil.get_ab42_jcoup_data">
<code class="descclassname">readutil.</code><code class="descname">get_ab42_jcoup_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#readutil.get_ab42_jcoup_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the J-coupling data for aB42 in ../test_data/</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a {JCoupID: val} dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="readutil.get_ab42_shift_data">
<code class="descclassname">readutil.</code><code class="descname">get_ab42_shift_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#readutil.get_ab42_shift_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the shift data for aB42 in ../test_data/</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a {ShiftID: val} dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="readutil.get_md_energies">
<code class="descclassname">readutil.</code><code class="descname">get_md_energies</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#readutil.get_md_energies" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the energy file containing all the energies for the
MD ensemble in in ../test_data/</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">{filename: energy} dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="readutil.read_dihed_file">
<code class="descclassname">readutil.</code><code class="descname">read_dihed_file</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#readutil.read_dihed_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the dihedral angle file written by write_dihed_to_file</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>path</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">numpy array containg dihedral angles</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="readutil.write_dihed_to_file">
<code class="descclassname">readutil.</code><code class="descname">write_dihed_to_file</code><span class="sig-paren">(</span><em>structs</em>, <em>outname</em>, <em>verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#readutil.write_dihed_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the dihedral angles of a list of structures into a tab-separated
file where each line represents a single structure and the columns
alternate phi, psi angles for each residue</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>structs</strong> &#8211; list of Structure objects</li>
<li><strong>outname</strong> &#8211; path to where the dihed file should be written</li>
<li><strong>verbose</strong> &#8211; If True updates will be written to terminal</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-util">
<span id="util"></span><h2>util<a class="headerlink" href="#module-util" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="util.normal_loglike">
<code class="descclassname">util.</code><code class="descname">normal_loglike</code><span class="sig-paren">(</span><em>x</em>, <em>mu</em>, <em>sig</em><span class="sig-paren">)</span><a class="headerlink" href="#util.normal_loglike" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the log likelihood of a value x in a normal distribution with
mean mu and stdev sig.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>x</strong> &#8211; list of values to calculate probability of</li>
<li><strong>mu</strong> &#8211; mean of distribuiton</li>
<li><strong>sig</strong> &#8211; standard deviation of distribution</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="references.html" class="btn btn-neutral float-right" title="References">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="use.html" class="btn btn-neutral" title="Use"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, David Brookes and Teresa Head-Gordon.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>